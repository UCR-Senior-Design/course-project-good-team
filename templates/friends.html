<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset="UTF-8">
        <title>Friends</title>
        <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/friends_styles.css') }}">
    </head>
    <body>
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <img src="{{ icon_link }}">
                </div>
                <div class="welcome">
                    <span class="weltext">Welcome to <span class="friend">Friendify</span>, <span id="username">{{ username }}</span></span>
                </div>
              <ul class="nav--list">
                <li class="item"><button><a href="/">Home</a></button></li>
                <li class="item"><button><a href="/about">About</a></button></li>
                <li class="item"><button><a href="/stats">Stats</a></button></li>
                <li class="item"><button><a href="/friends">Friends</a></button></li>
                <li class="item"><button><a href="/login" class="log">Login</a></button></li>
              </ul>
            </nav>
          </div>

          <div class="topspacer"></div>
          <body>
            <div class="centered-text">
                <h1>Your Friendify Friends</h1>
                {% if friends %}
                    <table>
                        <thead>
                            <tr>
                                <div class="spacer"></div>
                                    <th>Friend Username</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for friend in friends %}
                                <tr>
                                    <td>{{ friend }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>You have no friends added.</p>
                {% endif %}
            </div>
        </body>
        </html>

<!--           <div class="centered-text">
          <h1>Your Friendify Friends</h1>
          {% if friends %}
              <table>
                  <thead>
                    <div class="spacer"></div>
                      <tr>
                        <th class="centered-text">Friend Username</th>     
                      </tr>
                  </thead>
                  <tbody>
                      {% for friend in friends %}
                          <tr>
                            <td class="centered-text">{{ friend }}</td>
                          </tr>  
                      {% endfor %}
                  </tbody>
              </table>
          {% else %}
              <p>You have no friends added.</p>
          {% endif %}
        </div> -->

        <div class="spacer"></div>
        <div class="centered-text">
        <!-- Add Friend Button -->
        <!-- <button onclick="askForFriend()">Add Friend</button> -->
            <button class="item" onclick="askForFriend()">
                <span>Add Friend</span>
            </button>
        </div>    
        <script>
        function askForFriend() {
            var friendName = prompt("Enter friend's name:");
            
            if (friendName !== null) {
                    fetch('/addfriend', {
                        method: 'POST',
                        headers: {
                        'Content-Type': 'application/json',
                        },
                    body: JSON.stringify({ friendName: friendName }),
                    })
                    .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    location.reload();
                })
                .catch(error => {
                        console.error('Error:', error);
                });
            }
            }
        </script>

        <div class="topspacer"></div>
        <div class="centered-text">
            <p>Login on other platforms and exchange handles!</p>
        </div>
        <footer>
            <ul>
                <li class="footer"><a href="https://facebook.com">Facebook</a></li>
                <li class="footer"><a href="https://twitter.com">Twitter</a></li>
                <li class="footer"><a href="https://www.instagram.com">Instagram</a></li>
            </ul>
        </footer>

<!--         <div class="friends-container">
            <h2>Your Spotify Friends</h2>
            <ul id = 'friendsList'>
                friends list dynamically populated here
            </ul>
             <ul>
                {% for friend in friends %}
                    <li>{{ friend }}</li>
                {% endfor %}
            </ul>
        </div>

        <script>
            window.onload = function() {
                fetch('/getfriends')
                    .then(response => response.json())
                    .then(data => {
                        const friendsList = data.friends || [];
                        const friendsListContainer = document.getElementById('friendsList');

                        friendsList.forEach(friend => {
                            const listItem = document.createElement('li');
                            listItem.textContent = friend;
                            friendsListContainer.appendChild(listItem);
                        });
                    }) 
                    .catch(error => {
                        console.error('Error:', error);
                 });
             }
            }
        </script> -->


        <script>
            window.onload = function() {
                const username = "{{ username }}"; // Use the value from Flask session
                document.getElementById('username').textContent = username;
            };
        </script>
    </body>
</html>
